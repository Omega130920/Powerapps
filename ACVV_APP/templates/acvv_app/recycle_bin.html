<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Recycle Bin - ACVV</title>
    <style>
        body { font-family: sans-serif; background: linear-gradient(to bottom, #d1e2c4, rgb(143, 207, 127)); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h1 { color: #1b5e20; border-bottom: 2px solid #aed581; padding-bottom: 10px; margin-top: 0; }
        .task-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .task-table th { background: #43a047; color: white; padding: 12px; text-align: left; }
        .task-table td { padding: 12px; border-bottom: 1px solid #eee; font-size: 14px; }
        .btn { padding: 8px 15px; border-radius: 4px; text-decoration: none; color: white; font-size: 13px; cursor: pointer; border: none; }
        .btn-delete { background: #d32f2f; }
        .btn-restore { background: #f7931e; }
        .btn-view { background: #1976d2; }
        .btn-back { background: #1b5e20; display: inline-block; margin-bottom: 15px; padding: 10px 20px; }
        .empty-msg { text-align: center; padding: 40px; color: #666; }
        .toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    </style>
</head>
<body>
    <a href="{% url 'dashboard' %}" class="btn btn-back">← Back to Home Screen</a>
    
    <div class="container">
        <h1>♻️ Recycle Bin (Non-Work Related)</h1>
        
        {% if tasks %}
        <form action="{% url 'bulk_delete_recycled' %}" method="POST" id="bulkForm">
            {% csrf_token %}
            <div class="toolbar">
                <div>
                    <input type="checkbox" id="selectAll" onclick="toggleSelectAll(this)"> <strong>Select All</strong>
                </div>
                <div>
                    <button type="submit" name="delete_selected" class="btn btn-delete" onclick="return confirm('Delete selected items permanently?')">Delete Selected</button>
                    <button type="submit" name="empty_bin" class="btn btn-delete" style="background: black;" onclick="return confirm('EMPTY ENTIRE BIN?')">Empty Bin</button>
                </div>
            </div>

            <table class="task-table">
                <thead>
                    <tr>
                        <th style="width: 40px;"></th>
                        <th>Subject</th>
                        <th>From</th>
                        <th>Received Date</th>
                        <th style="text-align: right;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for task in tasks %}
                    <tr>
                        <td><input type="checkbox" name="selected_items" value="{{ task.delegation_id }}"></td>
                        <td><b>{{ task.subject }}</b></td>
                        <td>{{ task.from }}</td>
                        <td>{{ task.received|date:"d M Y, H:i" }}</td>
                        <td style="text-align: right;">
                            <a href="{% url 'view_recycled_item' task.delegation_id %}" class="btn btn-view">View</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </form>
        {% else %}
        <div class="empty-msg">
            <p>The recycle bin is currently empty.</p>
        </div>
        {% endif %}
    </div>

    <script>
        function toggleSelectAll(source) {
            checkboxes = document.getElementsByName('selected_items');
            for(var i=0, n=checkboxes.length; i<n; i++) {
                checkboxes[i].checked = source.checked;
            }
        }
    </script>
</body>
</html>