<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Line Data</title>
    <!-- Load Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Custom Tailwind configuration copied from the Import Data Page for a consistent theme
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-green': '#81c784', // Main accent, header text
                        'hover-green': '#66bb6a', Â // Hover state
                        'container-light': '#f0fff0', // Main content box background (Honeydew) 
                        'bg-top': '#d1e2c4', // Body background
                        'accent-border': '#c3e6cb', // Borders
                        'dark-title': '#1b5e20', // Dark green title color
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: sans-serif;
            background: linear-gradient(to bottom, #d1e2c4, #d1e2c4);
            margin: 20px;
            color: #333;
            line-height: 1.6;
        }

        h1 {
            color: #1b5e20;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .container {
            width: 95%;
            max-width: 98%;
            height: 90vh;
            display: flex;
            flex-direction: column;
            border-radius: 8px;
            background: #1b5e20
        }
        
        .controls-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .return-button {
            display: inline-block; padding: 10px 20px;
            background-color: #81c784; border: 1px solid #81c784; border-radius: 5px;
            text-decoration: none; color: white; cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .return-button:hover { background-color: #66bb6a; }

        .search-form {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-form input[type="text"] {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
            min-width: 250px;
        }
        
        .search-form button {
            padding: 8px 12px;
            background-color: #43a047;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .search-form button:hover {
            background-color: #388e3c;
        }

        table {
            width: 100%; border-collapse: collapse; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 5px; overflow: hidden; background-color: #f0fff0;
            border: 1px solid #f0fff0; margin-bottom: 20px; font-size: 0.9em;
        }
        thead th {
            background-color: #43a047; color: white; padding: 12px; text-align: left;
            font-weight: bold; border-bottom: 2px solid #388e3c; white-space: nowrap;
            border-right: 1px solid #388e3c;
        }
        thead th:last-child { border-right: none; }
        tbody td {
            padding: 10px 12px; border-bottom: 1px solid #aed581; border-right: 1px solid #aed581;
        }
        tbody td:last-child { border-right: none; }
        tbody tr:nth-child(even) { background-color: #e6ffe6; }
        tbody tr { cursor: pointer; } 
        tbody tr:hover { background-color: #ccffcc; }
        
        /* Pagination styles (Reused from ORG table) */
		.pagination-container {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-top: 20px;
			padding: 10px;
			border-top: 1px solid #c3e6cb;
			background-color: #f0fff0;
			border-radius: 0 0 8px 8px;
		}
		.pagination-link {
			padding: 8px 15px;
			background-color: #43a047;
			color: white;
			border-radius: 5px;
			text-decoration: none;
			transition: background-color 0.3s;
			font-weight: bold;
		}
		.pagination-link:hover:not(.disabled) {
			background-color: #388e3c;
		}
		.disabled {
			opacity: 0.5;
			cursor: not-allowed;
		}
    </style>
</head>

<!-- 
    BODY: Set to min-h-screen, padding, and use flex column layout to manage vertical space. 
    items-center ensures the content is horizontally centered.
-->
<body class="p-2 min-h-screen flex flex-col items-center">

    <!-- ADJUSTMENT: Changed max-w-screen-2xl to max-w-full for maximum width -->
    <div class="controls-container w-full max-w-full mx-auto mb-4 flex justify-between items-center">
        <!-- Back to Dashboard Link styling matches bankline.html -->
        <a href="{% url 'dashboard' %}" class="return-button">Back to Dashboard</a>
        </a>
    </div>

    <!-- 
        Main Container: Uses flex-grow to occupy remaining vertical space, 
        max-w-7xl for a wide container, and w-full for responsiveness.
    -->
    <div class="w-full max-w-full flex-grow bg-container-light p-4 shadow-xl rounded-xl border border-accent-border flex flex-col">
        
        <!-- Header -->
        <h1 class="text-3xl sm:text-4xl font-extrabold text-dark-title mb-8 border-b border-accent-border pb-3 text-center">
            Bank Line Transactions
        </h1>
        
        <!-- Table Wrapper for scrolling on small screens and defined vertical space -->
        <div class="scrollable-table-body shadow-lg rounded-lg border border-accent-border overflow-auto flex-grow">
            
            <table class="min-w-full divide-y divide-accent-border">
                
                <!-- Table Header - Set sticky top for persistent view during scroll -->
                <thead class="bg-primary-green/80 sticky top-0 z-10">
                    <tr>
                        <!--<th class="table-cell text-left text-xs font-semibold uppercase tracking-wider text-white">ID</th>-->
                        <th class="table-cell text-left text-xs font-semibold uppercase tracking-wider text-white">Date</th>
                        <th class="table-cell text-left text-xs font-semibold uppercase tracking-wider text-white">Description</th>
                        <th class="table-cell text-right text-xs font-semibold uppercase tracking-wider text-white">Amount (ZAR)</th>
                        <th class="table-cell text-left text-xs font-semibold uppercase tracking-wider text-white">Levy</th>
                        <th class="table-cell text-left text-xs font-semibold uppercase tracking-wider text-white">Fisical</th>
                        <th class="table-cell text-left text-xs font-semibold uppercase tracking-wider text-white">Type</th>
                        <!--<th class="table-cell text-center text-xs font-semibold uppercase tracking-wider text-white">Recon Status</th>-->
                    </tr>
                </thead>
                
                <!-- Table Body - Using Django Template Language -->
                <tbody class="divide-y divide-accent-border/50 bg-white">
                    
                    <!-- CHANGED: Iterate over the paginated data object -->
                    {% for line in bank_lines_page %}
                    <!-- ADDED: onclick event to redirect to the detail view using the bank_line's ID -->
                    <!-- ASSUMPTION: The URL name for the detail view is 'bankline_allocation' -->
                    <tr class="hover:bg-primary-green/10 transition duration-150 cursor-pointer"
                        onclick="window.location.href = '{% url 'bankline_allocation' bank_line_id=line.id %}';">
                        
                        <!-- Date -->
                        <td class="table-cell text-gray-700">{{ line.Date|date:"Y-m-d" }}</td>
                        
                        <!-- Description -->
                        <td class="table-cell text-gray-700 max-w-xs truncate" title="{{ line.Reference_Description }}">
                            {{ line.Reference_Description }}
                        </td>
                        
                        <!-- Amount (Conditional Styling for Debit/Credit) -->
                        <td class="table-cell font-semibold text-right
                            {% if line.Amount < 0 %}
                                text-red-700
                            {% else %}
                                text-primary-green
                            {% endif %}"
                        >
                            {{ line.Amount|floatformat:2 }}
                        </td>

                        <!-- Levy Number - Simplified styling for text field -->
                        <td class="table-cell text-gray-700 text-left">
                            {{ line.Levy_number|default:"-" }}
                        </td>

                        <!-- Fisical - Simplified styling for text field -->
                        <td class="table-cell text-gray-700 text-left">
                            {{ line.Fisical|default:"-" }}
                        </td>

                        <!-- Type -->
                        <td class="table-cell text-gray-700 text-left">
                            {{ line.Type|default:"-" }}
                        </td>
                        
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="table-cell text-center py-4 text-gray-500 italic">No bank lines have been imported yet.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Pagination Controls -->
        {% if bank_lines_page.has_other_pages %}
		<div class="pagination-container rounded-t-none">
			
			<!-- Previous Button -->
			{% if bank_lines_page.has_previous %}
				<a href="?page={{ bank_lines_page.previous_page_number }}" class="pagination-link">
					&larr; Previous
				</a>
			{% else %}
				<span class="pagination-link disabled">&larr; Previous</span>
			{% endif %}
			
			<!-- Page Status -->
			<span class="text-sm font-semibold text-gray-700">
				Page {{ bank_lines_page.number }} of {{ bank_lines_page.paginator.num_pages }}
				(Total Records: {{ bank_lines_page.paginator.count }})
			</span>
			
			<!-- Next Button -->
			{% if bank_lines_page.has_next %}
				<a href="?page={{ bank_lines_page.next_page_number }}" class="pagination-link">
					Next &rarr;
				</a>
			{% else %}
				<span class="pagination-link disabled">Next &rarr;</span>
			{% endif %}
		</div>
		{% endif %}

        
        <!-- Footer / Back Button -->
        <div class="mt-8 text-center flex-shrink-0">
            <a href="javascript:history.back()" 
                class="inline-block py-2 px-6 border border-transparent rounded-lg shadow-md text-sm font-semibold text-white 
                        bg-primary-green hover:bg-hover-green transition duration-200 
                        focus:outline-none focus:ring-4 focus:ring-primary-green focus:ring-opacity-50">
                &larr; Back to Import
            </a>
        </div>

    </div>
</body>
</html>
<!--